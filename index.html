<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conquistadores - Gesti칩n Ministerial</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#FDFBF7',  // Fondo Crema
                            100: '#F7F3E8', 
                            200: '#EFE5D1',
                            500: '#D97706', // 츼mbar/Dorado
                            600: '#C0392B', // Terracota Principal
                            700: '#A93226',
                            800: '#7B241C',
                            900: '#5D1C16', // Terracota Oscuro (Sidebar)
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #FDFBF7; }
        .hide-scroll::-webkit-scrollbar { display: none; }
        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    </style>
</head>
<body class="text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ICONOS SVG ---
        const Icons = {
            Users: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Wallet: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></svg>,
            LayoutDashboard: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>,
            Music: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>,
            Smile: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>,
            Bell: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>,
            LogOut: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>,
            Menu: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            Calendar: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Send: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            Clipboard: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>,
            Trash: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>,
            Plus: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
        };

        // --- COMPONENTES UI BASE ---
        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-2xl shadow-sm border border-brand-200 p-6 ${className}`}>{children}</div>
        );

        const Button = ({ children, onClick, variant = "primary", className = "", icon: IconName, disabled=false }) => {
            const base = "flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl font-bold text-sm transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed";
            const variants = {
                primary: "bg-brand-600 text-white hover:bg-brand-700 shadow-md shadow-brand-600/20",
                secondary: "bg-white text-slate-600 border border-slate-200 hover:bg-slate-50",
                danger: "bg-red-50 text-red-600 border border-red-100 hover:bg-red-100",
                ghost: "text-slate-500 hover:bg-brand-50 hover:text-brand-700",
            };
            const Icon = IconName ? Icons[IconName] : null;
            return <button onClick={onClick} disabled={disabled} className={`${base} ${variants[variant]} ${className}`}>{Icon && <Icon width={18}/>}{children}</button>;
        };

        const Input = ({ label, ...props }) => (
            <div className="flex flex-col gap-1.5 mb-4">
                <label className="text-xs font-bold text-slate-500 uppercase tracking-wide">{label}</label>
                <input className="w-full px-4 py-3 bg-brand-50 border border-brand-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-600/30 transition-all font-medium text-slate-700" {...props}/>
            </div>
        );

        const Select = ({ label, children, ...props }) => (
            <div className="flex flex-col gap-1.5 mb-4">
                <label className="text-xs font-bold text-slate-500 uppercase tracking-wide">{label}</label>
                <div className="relative">
                    <select className="w-full px-4 py-3 bg-brand-50 border border-brand-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-600/30 transition-all font-medium text-slate-700 appearance-none" {...props}>
                        {children}
                    </select>
                </div>
            </div>
        );

        const Badge = ({ children, color = "brand" }) => {
             const colors = {
                brand: "bg-brand-100 text-brand-800 border-brand-200",
                green: "bg-emerald-100 text-emerald-800 border-emerald-200",
                blue: "bg-blue-100 text-blue-800 border-blue-200",
            };
            return <span className={`px-2 py-0.5 rounded-md text-xs font-bold border ${colors[color] || colors.brand}`}>{children}</span>
        };

        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in">
                    <div className="bg-white w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl">
                        <div className="p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10">
                            <h3 className="text-xl font-bold text-slate-800">{title}</h3>
                            <button onClick={onClose} className="p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors">
                                <Icons.Trash className="rotate-45" width={24}/> 
                            </button>
                        </div>
                        <div className="p-6">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };

        // --- MOCK DATA ---
        const MOCK_MEMBERS = [
            { id: 1, name: 'Carlos (L칤der Alabanza)', age: 32, ministry: 'Alabanza', role: 'Leader', status: 'Activo' },
            { id: 2, name: 'Ana (Pastora)', age: 45, ministry: 'Pastoral', role: 'Pastor', status: 'Activo' },
            { id: 3, name: 'Lucas (Joven)', age: 16, ministry: 'J칩venes', role: 'Member', status: 'Activo' },
            { id: 4, name: 'Sof칤a (Ni침a)', age: 8, ministry: 'EBD', role: 'Child', status: 'Activo' },
            { id: 5, name: 'Pedro (Servidor)', age: 28, ministry: 'Ujieres', role: 'Server', status: 'Activo' },
            { id: 6, name: 'Marta (Maestra EBD)', age: 35, ministry: 'EBD', role: 'Leader', status: 'Activo' },
            { id: 7, name: 'Juan (L칤der J칩venes)', age: 24, ministry: 'J칩venes', role: 'Leader', status: 'Activo' },
        ];

        const MOCK_SONGS = [
            { id: 1, title: 'Tu Fidelidad', tags: ['Adoraci칩n'], lastUsed: '2023-11-01' },
            { id: 2, title: 'En los Montes', tags: ['J칰bilo', 'Guerra'], lastUsed: '2023-10-20' },
            { id: 3, title: 'Santo Esp칤ritu', tags: ['Adoraci칩n'], lastUsed: '2023-11-15' },
        ];

        const MOCK_NOTIFICATIONS = [
            { id: 1, from: 'Pastoral', to: 'all', message: 'Reuni칩n general de servidores este Viernes 20hs.', date: '2023-11-20' },
            { id: 2, from: 'Pastoral', to: 'Worship', message: 'Recordar subir lista de temas antes del lunes.', date: '2023-11-21' },
        ];
        
        const MOCK_EVENTS = [
            { id: 1, title: 'Culto General', date: '2023-11-28', type: 'General' },
            { id: 2, title: 'Ensayo Alabanza', date: '2023-11-29', type: 'Alabanza' }
        ];

        // --- PANTALLAS ESPEC칈FICAS ---

        // 1. DASHBOARD COMPARTIDO
        const Dashboard = ({ user, members, notifications }) => {
            const myNotifications = notifications.filter(n => n.to === 'all' || n.to === user.ministry || (user.role === 'Pastor'));

            return (
                <div className="space-y-6 animate-fade-in">
                    <header className="flex justify-between items-end">
                        <div>
                            <h2 className="text-3xl font-extrabold text-brand-800">Hola, {user.name.split(' ')[0]} 游녦</h2>
                            <p className="text-slate-500 font-medium">Panel de {user.role === 'Pastor' ? 'Administraci칩n' : user.ministry}</p>
                        </div>
                        <div className="text-right hidden md:block">
                            <p className="text-xs font-bold text-slate-400 uppercase">Fecha</p>
                            <p className="text-lg font-bold text-brand-700">{new Date().toLocaleDateString()}</p>
                        </div>
                    </header>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <Card className="border-l-4 border-l-brand-600 md:col-span-2">
                            <h3 className="font-bold text-slate-700 flex items-center gap-2 mb-4">
                                <Icons.Bell width={20} className="text-brand-600"/> Mensajes Importantes
                            </h3>
                            <div className="space-y-3">
                                {myNotifications.length > 0 ? myNotifications.map(n => (
                                    <div key={n.id} className="bg-brand-50 p-3 rounded-xl flex gap-3 items-start">
                                        <div className="w-8 h-8 rounded-full bg-brand-200 flex items-center justify-center text-brand-800 font-bold text-xs flex-shrink-0">
                                            {n.from.charAt(0)}
                                        </div>
                                        <div>
                                            <p className="text-sm font-bold text-brand-900">{n.from}</p>
                                            <p className="text-sm text-slate-600">{n.message}</p>
                                            <p className="text-[10px] text-slate-400 mt-1">{n.date}</p>
                                        </div>
                                    </div>
                                )) : <p className="text-slate-400 italic">No tienes mensajes nuevos.</p>}
                            </div>
                        </Card>
                        
                        <Card className="bg-gradient-to-br from-brand-800 to-brand-900 text-white border-none">
                            {user.role === 'Server' && (
                                <>
                                    <p className="text-brand-200 text-xs font-bold uppercase">Tu Servicio</p>
                                    <h3 className="text-2xl font-bold mt-1">{user.ministry}</h3>
                                    <p className="text-sm text-brand-100 mt-2 opacity-80">Sirviendo con excelencia</p>
                                </>
                            )}
                            {user.role === 'Pastor' && (
                                <>
                                    <p className="text-brand-200 text-xs font-bold uppercase">Membres칤a Total</p>
                                    <h3 className="text-3xl font-bold mt-1">{members.length}</h3>
                                    <p className="text-sm text-brand-100 mt-2 opacity-80">{members.filter(m => m.status === 'Activo').length} Activos</p>
                                </>
                            )}
                             {(user.role !== 'Pastor' && user.role !== 'Server') && (
                                <>
                                    <p className="text-brand-200 text-xs font-bold uppercase">Equipo</p>
                                    <h3 className="text-2xl font-bold mt-1">{user.ministry}</h3>
                                    <p className="text-sm text-brand-100 mt-2 opacity-80">Gesti칩n de 치rea</p>
                                </>
                            )}
                        </Card>
                    </div>
                </div>
            );
        };

        // 2. M칍DULO ALABANZA
        const WorshipModule = ({ user }) => {
            const [tab, setTab] = useState('roster'); 
            const [songs, setSongs] = useState(MOCK_SONGS);
            
            const futureDates = useMemo(() => {
                const dates = [];
                let d = new Date();
                for(let i=0; i<4; i++) { 
                    d.setDate(d.getDate() + (d.getDay() === 2 ? 4 : 3)); 
                    dates.push(new Date(d));
                }
                return dates;
            }, []);

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold text-brand-800 flex items-center gap-2">
                            <Icons.Music className="text-brand-600"/> Gesti칩n de Alabanza
                        </h2>
                        <div className="flex bg-white rounded-lg border border-slate-200 p-1">
                            <button onClick={() => setTab('roster')} className={`px-4 py-1.5 rounded-md text-sm font-bold ${tab === 'roster' ? 'bg-brand-100 text-brand-800' : 'text-slate-500'}`}>Cuadrante</button>
                            <button onClick={() => setTab('songs')} className={`px-4 py-1.5 rounded-md text-sm font-bold ${tab === 'songs' ? 'bg-brand-100 text-brand-800' : 'text-slate-500'}`}>Canciones</button>
                        </div>
                    </div>

                    {tab === 'roster' && (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            {futureDates.map((date, idx) => (
                                <Card key={idx} className="hover:border-brand-400 transition-colors cursor-pointer group">
                                    <p className="text-xs font-bold text-brand-600 uppercase mb-2">
                                        {date.toLocaleDateString(undefined, {weekday: 'long'})}
                                    </p>
                                    <h3 className="text-xl font-extrabold text-slate-800 mb-4">
                                        {date.toLocaleDateString(undefined, {day: 'numeric', month: 'short'})}
                                    </h3>
                                    <div className="text-sm space-y-1 text-slate-600">
                                        <p><span className="font-bold text-slate-400">L칤der:</span> {idx % 2 === 0 ? 'Carlos' : 'Ana'}</p>
                                    </div>
                                </Card>
                            ))}
                        </div>
                    )}

                    {tab === 'songs' && (
                        <Card>
                            <div className="flex justify-between mb-4">
                                <h3 className="font-bold text-slate-700">Biblioteca</h3>
                                <Button className="!py-1 !px-3 text-xs" icon="Clipboard">Nueva</Button>
                            </div>
                            <table className="w-full text-left text-sm">
                                <thead className="bg-slate-50 text-slate-500 uppercase font-bold text-xs">
                                    <tr><th className="p-3">T칤tulo</th><th className="p-3">Etiquetas</th></tr>
                                </thead>
                                <tbody>
                                    {songs.map(s => (
                                        <tr key={s.id} className="border-b border-slate-50 hover:bg-slate-50">
                                            <td className="p-3 font-bold text-slate-700">{s.title}</td>
                                            <td className="p-3"><div className="flex gap-1">{s.tags.map(t => <Badge key={t} color="blue">{t}</Badge>)}</div></td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </Card>
                    )}
                </div>
            );
        };

        // 3. M칍DULO EBD / J칍VENES
        const MinistryDirectoryModule = ({ title, members, minAge, maxAge, icon: Icon }) => {
            const filteredMembers = members.filter(m => m.age >= minAge && m.age <= maxAge);
            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold text-brand-800 flex items-center gap-2">
                            <Icon className="text-brand-600"/> {title}
                        </h2>
                        <div className="bg-brand-100 text-brand-800 px-3 py-1 rounded-lg text-xs font-bold">
                            {filteredMembers.length} Personas
                        </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        {filteredMembers.map(m => (
                            <div key={m.id} className="bg-white p-4 rounded-xl border border-brand-200 shadow-sm flex items-center gap-4">
                                <div className="w-10 h-10 rounded-full bg-brand-50 text-brand-700 flex items-center justify-center font-bold text-lg border border-brand-100">
                                    {m.name.charAt(0)}
                                </div>
                                <div>
                                    <h4 className="font-bold text-slate-800">{m.name}</h4>
                                    <p className="text-xs text-slate-500">{m.age} a침os</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        
        // 4. M칍DULO DIRECTORIO GENERAL (Para Pastor y Servidores)
        const GeneralMembersModule = ({ user, members, setMembers }) => {
            const [isModalOpen, setModalOpen] = useState(false);
            const [newMember, setNewMember] = useState({ name: '', age: '', ministry: 'General' });

            const handleAdd = () => {
                if(!newMember.name) return;
                setMembers([...members, { id: Date.now(), ...newMember, status: 'Activo', role: 'Member' }]);
                setModalOpen(false);
                setNewMember({ name: '', age: '', ministry: 'General' });
            };

            const handleDelete = (id) => {
                if(confirm('쮼st치s seguro de eliminar este miembro?')) {
                    setMembers(members.filter(m => m.id !== id));
                }
            };

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold text-brand-800 flex items-center gap-2">
                            <Icons.Users className="text-brand-600"/> Directorio General
                        </h2>
                        {/* El Servidor PUEDE AGREGAR, al igual que el Pastor */}
                        <Button onClick={() => setModalOpen(true)} icon="Plus">Nueva Ficha</Button>
                    </div>

                    <Card>
                        <table className="w-full text-left text-sm">
                            <thead className="bg-slate-50 text-slate-500 uppercase font-bold text-xs">
                                <tr>
                                    <th className="p-4">Nombre</th>
                                    <th className="p-4">Ministerio</th>
                                    <th className="p-4">Estado</th>
                                    {/* Solo el Pastor ve la columna de acciones de borrado */}
                                    {user.role === 'Pastor' && <th className="p-4 text-right">Acciones</th>}
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-100">
                                {members.map(m => (
                                    <tr key={m.id} className="hover:bg-brand-50/50">
                                        <td className="p-4 font-bold text-slate-700">{m.name}</td>
                                        <td className="p-4 text-slate-500">{m.ministry}</td>
                                        <td className="p-4"><Badge color={m.status === 'Activo' ? 'green' : 'brand'}>{m.status}</Badge></td>
                                        
                                        {/* LOGICA DE SEGURIDAD: Solo Pastor puede eliminar */}
                                        {user.role === 'Pastor' && (
                                            <td className="p-4 text-right">
                                                <button onClick={() => handleDelete(m.id)} className="text-slate-400 hover:text-red-500 transition-colors">
                                                    <Icons.Trash width={18}/>
                                                </button>
                                            </td>
                                        )}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </Card>

                    <Modal isOpen={isModalOpen} onClose={() => setModalOpen(false)} title="Agregar Miembro">
                        <div className="space-y-4">
                            <Input label="Nombre Completo" value={newMember.name} onChange={e => setNewMember({...newMember, name: e.target.value})} />
                            <Input label="Edad" type="number" value={newMember.age} onChange={e => setNewMember({...newMember, age: e.target.value})} />
                            <Select label="Ministerio" value={newMember.ministry} onChange={e => setNewMember({...newMember, ministry: e.target.value})}>
                                <option value="General">General</option>
                                <option value="Alabanza">Alabanza</option>
                                <option value="Ujieres">Ujieres</option>
                                <option value="J칩venes">J칩venes</option>
                            </Select>
                            <div className="flex justify-end gap-2 mt-4">
                                <Button variant="secondary" onClick={() => setModalOpen(false)}>Cancelar</Button>
                                <Button onClick={handleAdd}>Guardar</Button>
                            </div>
                        </div>
                    </Modal>
                </div>
            );
        };
        
        // 5. M칍DULO CALENDARIO (Visible para todos)
        const CalendarModule = ({ events }) => {
            const days = Array.from({length: 30}, (_, i) => i + 1);
            return (
                <div className="space-y-6 animate-fade-in">
                     <div>
                        <h2 className="text-2xl font-bold text-brand-800">Calendario Mensual</h2>
                        <p className="text-slate-500 text-sm">Eventos y actividades</p>
                    </div>
                    <div className="bg-white rounded-2xl shadow-sm border border-brand-200 p-6">
                        <div className="grid grid-cols-7 gap-2">
                            {days.map(day => (
                                <div key={day} className="min-h-[80px] border border-slate-100 rounded-lg p-2 hover:bg-brand-50 transition-colors">
                                    <span className="text-xs font-bold text-slate-400">{day}</span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            )
        }

        // --- APP PRINCIPAL ---
        const App = () => {
            const [user, setUser] = useState(null); 
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isSidebarOpen, setSidebarOpen] = useState(false);
            const [members, setMembers] = useState(MOCK_MEMBERS);
            const [notifications, setNotifications] = useState(MOCK_NOTIFICATIONS);

            // PANTALLA DE LOGIN SIMULADA
            if (!user) {
                return (
                    <div className="min-h-screen bg-brand-50 flex items-center justify-center p-4">
                        <div className="w-full max-w-md bg-white p-8 rounded-3xl shadow-xl border border-brand-100">
                            <div className="text-center mb-8">
                                <div className="w-16 h-16 bg-brand-600 rounded-2xl mx-auto flex items-center justify-center text-white mb-4 shadow-lg shadow-brand-600/40">
                                    <span className="font-extrabold text-2xl">C</span>
                                </div>
                                <h1 className="text-2xl font-extrabold text-slate-800">Bienvenido</h1>
                                <p className="text-slate-500">Selecciona tu rol para ingresar</p>
                            </div>
                            <div className="space-y-3">
                                <button onClick={() => setUser(MOCK_MEMBERS[1])} className="w-full p-4 text-left border rounded-xl hover:bg-brand-50 hover:border-brand-600 transition-all group">
                                    <div className="font-bold text-slate-800 group-hover:text-brand-700">Pastoral</div>
                                    <div className="text-xs text-slate-500">Acceso total</div>
                                </button>
                                <button onClick={() => setUser(MOCK_MEMBERS[0])} className="w-full p-4 text-left border rounded-xl hover:bg-brand-50 hover:border-brand-600 transition-all group">
                                    <div className="font-bold text-slate-800 group-hover:text-brand-700">L칤der Alabanza</div>
                                    <div className="text-xs text-slate-500">Gesti칩n de m칰sica</div>
                                </button>
                                {/* CORRECCION DE SINTAXIS AQUI: &lt; en lugar de < */}
                                <button onClick={() => setUser(MOCK_MEMBERS[5])} className="w-full p-4 text-left border rounded-xl hover:bg-brand-50 hover:border-brand-600 transition-all group">
                                    <div className="font-bold text-slate-800 group-hover:text-brand-700">L칤der EBD (Ni침os)</div>
                                    <div className="text-xs text-slate-500">Directorio &lt; 12 a침os + Clases</div>
                                </button>
                                <button onClick={() => setUser(MOCK_MEMBERS[4])} className="w-full p-4 text-left border rounded-xl hover:bg-brand-50 hover:border-brand-600 transition-all group">
                                    <div className="font-bold text-slate-800 group-hover:text-brand-700">Servidor / Ujier</div>
                                    <div className="text-xs text-slate-500">Ver Calendario + Agregar Fichas</div>
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            const SidebarItem = ({ id, icon: IconName, label }) => {
                const Icon = Icons[IconName];
                const isActive = activeTab === id;
                return (
                    <button 
                        onClick={() => { setActiveTab(id); setSidebarOpen(false); }}
                        className={`w-full flex items-center gap-3 px-4 py-3.5 rounded-xl font-bold text-sm transition-all duration-200 ${
                            isActive 
                                ? 'bg-brand-600 text-white shadow-lg shadow-black/20' 
                                : 'text-brand-200 hover:bg-brand-800 hover:text-white'
                        }`}
                    >
                        <Icon width={20} className={isActive ? 'text-white' : 'opacity-70'} />
                        {label}
                    </button>
                );
            };

            return (
                <div className="min-h-screen flex bg-brand-50 selection:bg-brand-200 selection:text-brand-900 font-sans">
                    
                    {/* SIDEBAR */}
                    <aside className={`
                        fixed md:sticky top-0 h-screen w-72 bg-[#5D1C16] text-white p-6 z-40 transition-transform duration-300 shadow-2xl flex flex-col justify-between
                        ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'}
                    `}>
                        <div>
                            <div className="flex items-center gap-3 mb-10 px-2 mt-2">
                                <div className="w-10 h-10 bg-brand-600 rounded-lg flex items-center justify-center text-white font-extrabold shadow-lg border border-brand-500">C</div>
                                <div>
                                    <h1 className="font-bold text-lg leading-none tracking-tight">Conquistadores</h1>
                                    <p className="text-[10px] text-brand-300 uppercase tracking-widest font-bold mt-1">Gesti칩n Interna</p>
                                </div>
                            </div>

                            <nav className="space-y-1.5">
                                <SidebarItem id="dashboard" icon="LayoutDashboard" label="Inicio" />
                                
                                {/* L칩gica de Men칰: Pastor ve todo. Servidor ve Directorio y Calendario. */}
                                
                                {(user.role === 'Pastor' || user.role === 'Server') && (
                                    <>
                                        <SidebarItem id="members" icon="Users" label="Directorio General" />
                                        <SidebarItem id="calendar" icon="Calendar" label="Calendario" />
                                    </>
                                )}

                                {(user.role === 'Pastor' || user.ministry === 'Alabanza') && (
                                    <SidebarItem id="worship" icon="Music" label="Alabanza" />
                                )}
                                {(user.role === 'Pastor' || user.ministry === 'EBD') && (
                                    <SidebarItem id="ebd" icon="Smile" label="Escuela B칤blica" />
                                )}
                                
                                {(user.role === 'Pastor') && (
                                    <>
                                        <SidebarItem id="finance" icon="Wallet" label="Tesorer칤a" />
                                        <SidebarItem id="admin" icon="Send" label="Mensajer칤a" />
                                    </>
                                )}
                            </nav>
                        </div>

                        <div className="bg-brand-800/50 rounded-xl p-4 border border-brand-700 flex items-center gap-3">
                            <div className="w-9 h-9 rounded-full bg-brand-500 flex items-center justify-center text-sm font-bold text-white border-2 border-brand-900">
                                {user.name.charAt(0)}
                            </div>
                            <div className="overflow-hidden flex-1">
                                <p className="text-sm font-bold text-white truncate">{user.name.split(' ')[0]}</p>
                                <p className="text-[11px] text-brand-200 truncate uppercase font-bold">{user.role === 'Server' ? 'Servidor' : user.ministry}</p>
                            </div>
                            <button onClick={() => setUser(null)} className="text-brand-300 hover:text-white transition-colors" title="Salir">
                                <Icons.LogOut width={18}/>
                            </button>
                        </div>
                    </aside>

                    {/* OVERLAY M칍VIL */}
                    {isSidebarOpen && <div className="fixed inset-0 bg-black/50 z-30 md:hidden backdrop-blur-sm" onClick={() => setSidebarOpen(false)} />}

                    {/* CONTENIDO PRINCIPAL */}
                    <main className="flex-1 h-screen overflow-y-auto relative">
                        <header className="bg-white/90 backdrop-blur-md sticky top-0 z-20 border-b border-brand-200 px-6 py-4 flex justify-between items-center md:hidden">
                            <div className="font-bold text-brand-900 text-lg">Conquistadores</div>
                            <button onClick={() => setSidebarOpen(true)} className="p-2 text-brand-800 active:bg-brand-100 rounded-lg">
                                <Icons.Menu width={24} />
                            </button>
                        </header>

                        <div className="p-6 md:p-10 max-w-6xl mx-auto pb-24">
                            {activeTab === 'dashboard' && <Dashboard user={user} members={members} notifications={notifications} />}
                            
                            {(activeTab === 'worship' && (user.role === 'Pastor' || user.ministry === 'Alabanza')) && <WorshipModule user={user} />}
                            {(activeTab === 'ebd' && (user.role === 'Pastor' || user.ministry === 'EBD')) && <MinistryDirectoryModule title="Escuela B칤blica" icon={Icons.Smile} members={members} minAge={0} maxAge={12} />}
                            
                            {/* VISTA MIEMBROS GENERAL: Accesible para Pastor y Server */}
                            {(activeTab === 'members' && (user.role === 'Pastor' || user.role === 'Server')) && 
                                <GeneralMembersModule user={user} members={members} setMembers={setMembers} />
                            }

                            {/* VISTA CALENDARIO: Accesible para Pastor y Server */}
                            {(activeTab === 'calendar' && (user.role === 'Pastor' || user.role === 'Server')) && 
                                <CalendarModule events={MOCK_EVENTS} />
                            }

                            {activeTab === 'finance' && (
                                <div className="text-center py-20 animate-fade-in">
                                    <div className="w-20 h-20 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-4 text-brand-600">
                                        <Icons.Wallet width={40}/>
                                    </div>
                                    <h2 className="text-2xl font-bold text-slate-700">Tesorer칤a</h2>
                                    <p className="text-slate-500">M칩dulo exclusivo pastoral</p>
                                </div>
                            )}
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
